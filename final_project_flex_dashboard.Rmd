---
title: "ERHS 535 Final Project"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(readr) #chang
library(tidyverse)
library(dplyr)
library(DT)
plastics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-26/plastics.csv')
```

### Master Code

```{r}
plastics <- plastics %>%
  mutate(count_per_volunteer = (grand_total / volunteers)) %>%
  mutate(country = str_to_title(country))
```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}

```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
plastic_companies <- plastics %>%
  select(year, parent_company, grand_total) %>%
  #filter(year == "2019") %>%
  filter(parent_company != "Grand Total") %>%
  filter(parent_company != "null") %>%
  filter(parent_company != "NULL") %>%
  filter(parent_company != "Unbranded") %>%
  na.omit() %>%
  group_by(year, parent_company) %>%
  summarise(ggrand = sum(grand_total)) %>%
  arrange(desc(ggrand)) %>%
  ungroup() %>%
  rename(Company = parent_company) %>%
  rename(Total = ggrand) %>%
  pivot_wider(id_cols = "Company",
              names_from = "year",
              values_from = "Total") %>%
  datatable(options = list(pagelength = 12), caption = "Total Collected Pieces of Plastic Pollution per Top 20 Companies in 2019")
plastic_companies
```

### Chart C

```{r}

```

